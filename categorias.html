<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Categor√≠as - Realfoodaholic</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <div class="header-content">
            <a href="index.html" class="logo">
                <img src="img/avatar.jpg" alt="Realfoodaholic">
                <div class="logo-text">
                    <span>realfoodaholic</span>
                    <nav>
                        <a href="index.html">Inicio</a>
                        <a href="categorias.html">Categor√≠as</a>
                        <a href="contacto.html">Contacto</a>
                    </nav>
                </div>
            </a>
        </div>
    </header>
    
    <main class="container" style="padding: 40px 20px;">
        <h1 class="section-title">Categor√≠as</h1>
        <div id="categories-grid" class="categories-grid">
            <p style="text-align: center; padding: 40px;">Cargando categor√≠as...</p>
        </div>
    </main>
    <<footer>
    <div class="container">
        <p>Realfoodaholic - Recetas de comida real ü•ó</p>
        <p><a href="/legal.html" style="color: rgba(255,255,255,0.6); font-size: 0.85rem;">Aviso Legal y Privacidad</a></p>
    </div>
</footer>
    
    <script>
    // Mapeo de slugs a nombres de categor√≠as
    const categoriasNombres = {
        "platos-principales": "Platos principales",
        "ensaladas": "Ensaladas",
        "desayunos-2": "Desayunos",
        "postres": "Postres",
        "recetas-veganas": "Veganas",
        "snacks-2": "Snacks dulces",
        "snacks": "Snacks salados",
        "sopas-y-cremas": "Sopas y cremas",
        "salsas": "Salsas y pat√©s",
        "acompanamientos": "Acompa√±amientos",
        "olla-lenta": "Olla lenta",
        "microondas": "Microondas",
		"alimentacion-saludable": "Alimentaci√≥n saludable",
        "comercio-local": "Comercio local y restauraci√≥n",
        "videos": "V√≠deos"
    };

    // Orden de las categor√≠as
    const ordenCategorias = [
        "platos-principales",
        "ensaladas", 
        "desayunos-2",
        "postres",
        "recetas-veganas",
        "snacks-2",
        "snacks",
        "sopas-y-cremas",
        "salsas",
        "acompanamientos",
        "olla-lenta",
        "microondas",
		"alimentacion-saludable",
        "comercio-local",
        "videos"
    ];

    async function cargarCategorias() {
        try {
            const response = await fetch('/recetas-nuevas.json');
            if (!response.ok) throw new Error('No se pudo cargar el JSON');
            
            const recetas = await response.json();
            
            // Agrupar recetas por categor√≠a
            const porCategoria = {};
            
            recetas.forEach(receta => {
                if (!receta.categories) return;
                
                receta.categories.forEach(cat => {
                    if (!porCategoria[cat]) {
                        porCategoria[cat] = [];
                    }
                    // Evitar duplicados
                    if (!porCategoria[cat].find(r => r.slug === receta.slug)) {
                        porCategoria[cat].push(receta);
                    }
                });
            });

            // Ordenar recetas dentro de cada categor√≠a por fecha (m√°s recientes primero)
            Object.keys(porCategoria).forEach(cat => {
                porCategoria[cat].sort((a, b) => new Date(b.date) - new Date(a.date));
            });

            // Generar HTML
            const grid = document.getElementById('categories-grid');
            let html = '';

            ordenCategorias.forEach(catSlug => {
                const recetasCat = porCategoria[catSlug];
                if (!recetasCat || recetasCat.length === 0) return;

                const nombreCat = categoriasNombres[catSlug] || catSlug;
                const total = recetasCat.length;
                const mostrar = recetasCat.slice(0, 8); // Mostrar las primeras 8

                html += `
                <div class="category-card" data-category="${catSlug}">
                    <h2><a href="index.html#${catSlug}">${nombreCat} (<span class="cat-count">${total}</span>)</a></h2>
                    <ul>
                        ${mostrar.map(r => `<li><a href="recetas/${r.slug}.html">${r.title}</a></li>`).join('')}
                        ${total > 8 ? `<li><a href="index.html#${catSlug}" class="ver-mas">... y ${total - 8} recetas m√°s ‚Üí</a></li>` : ''}
                    </ul>
                </div>
                `;
            });

            grid.innerHTML = html;

        } catch(e) {
            console.error('Error cargando categor√≠as:', e);
            document.getElementById('categories-grid').innerHTML = 
                '<p style="text-align: center; color: red;">Error cargando las categor√≠as. Por favor, recarga la p√°gina.</p>';
        }
    }

    cargarCategorias();
    </script>
</body>
</html>
